# 登录功能测试说明

## 一、清空数据库里的所有账号

在项目根目录（`my-second-brain`）执行以下命令之一：

**方式 1（推荐，Node 20.6+）：**
```bash
node --env-file=.env.local scripts/clear-auth-users.mjs
```

**方式 2（任意 Node 版本）：**
```bash
# 在项目根目录执行
export $(grep -v '^#' .env.local | xargs) && node scripts/clear-auth-users.mjs
```

脚本会列出并删除所有 Auth 用户，输出类似：
```
已删除: user@example.com
已删除: test@test.com
共删除 2 个账号。
```

> 注意：该脚本使用 `SUPABASE_SERVICE_ROLE_KEY`，仅适合在本地/开发环境运行，切勿暴露到前端或生产环境。

---

## 二、登录功能复测步骤

清空账号后，按下面顺序测试。

1. **注册新用户**
   - 打开 `/signup`
   - 输入邮箱、密码、确认密码（两次一致，至少 6 位）
   - 点击「注册」→ 应跳转到首页 `/`

2. **已注册邮箱再次注册**
   - 打开 `/signup`，用同一邮箱再注册一次
   - 应提示：「你已经注册过了，请直接登录」

3. **密码登录**
   - 打开 `/login`
   - 输入刚注册的邮箱和正确密码 → 应跳转到首页

4. **错误密码**
   - 打开 `/login`，输入正确邮箱、错误密码
   - 应提示：「邮箱或密码错误」

5. **未登录访问首页**
   - 先退出登录（首页右上角「退出」），或使用无痕窗口
   - 直接访问 `/` → 应被重定向到 `/login`

6. **登录后访问首页**
   - 登录后访问 `/` → 应正常显示首页和最近笔记

7. **退出登录**
   - 在首页点击「退出」→ 应跳转到登录页，再次访问 `/` 需重新登录

完成以上步骤即完成登录功能的基本复测。
